<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Game Over Tracker</title>
    
    <!-- Modern PWA Meta Tags -->
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Game Over">
    <meta name="theme-color" content="#0f172a">
    
    <!-- PWA Manifest -->
    <link rel="manifest" href="/manifest.json">
    
    <!-- App Icons -->
    <link rel="icon" type="image/png" sizes="192x192" href="/icon-192.png">
    <link rel="icon" type="image/png" sizes="512x512" href="/icon-512.png">
    <link rel="apple-touch-icon" href="/icon-192.png">
    <link rel="apple-touch-icon" sizes="192x192" href="/icon-192.png">
    <link rel="apple-touch-icon" sizes="512x512" href="/icon-512.png">

    <!-- Tailwind CSS (Development CDN) -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>tailwind.config = { darkMode: 'class' }</script>
    
    <!-- Stable Production CDNs -->
    <script src="https://unpkg.com/react@18.3.1/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18.3.1/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/prop-types@15.8.1/prop-types.min.js"></script>
    <script src="https://unpkg.com/recharts@2.12.7/umd/Recharts.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <style>
        body { -webkit-tap-highlight-color: transparent; background-color: #f8fafc; }
        html.dark body { background-color: #020617; }
        #root:empty { display: none; }
        .loading-fallback {
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            height: 100vh; font-family: sans-serif; background: #0f172a; color: white;
        }
    </style>
</head>
<body>
    <div id="root">
        <div class="loading-fallback">
            <div style="font-weight: 900; font-style: italic; font-size: 24px; text-transform: uppercase; letter-spacing: -1px;">Game Over</div>
            <div style="font-size: 10px; color: #ef4444; margin-top: 8px; font-weight: bold; letter-spacing: 2px;">INITIALIZING SYSTEM...</div>
        </div>
    </div>

    <script type="text/babel">
        const initApp = () => {
            if (typeof window.Recharts === 'undefined' || typeof window.React === 'undefined') {
                setTimeout(initApp, 100);
                return;
            }
            renderApp();
        };

        const renderApp = () => {
            const { useState, useEffect, useMemo } = React;
            const { LineChart, Line, XAxis, YAxis, CartesianGrid, Tooltip, ResponsiveContainer, Legend, ComposedChart, Scatter } = Recharts;
            
            const Icons = {
                Dumbbell: () => (
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="m6.5 6.5 11 11"/><path d="m10 10 5.5 5.5"/><path d="m3 7 4 4"/><path d="m9 3 4 4"/><path d="m17 13 4 4"/><path d="m13 17 4 4"/></svg>
                ),
                Save: () => (
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"/><polyline points="17 21 17 13 7 13 7 21"/><polyline points="7 3 7 8 15 8"/></svg>
                ),
                Calendar: () => (
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><rect width="18" height="18" x="3" y="4" rx="2" ry="2"/><line x1="16" x2="16" y1="2" y2="6"/><line x1="8" x2="8" y1="2" y2="6"/><line x1="3" x2="21" y1="10" y2="10"/></svg>
                ),
                BarChart3: () => (
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M3 3v18h18"/><path d="M18 17V9"/><path d="M13 17V5"/><path d="M8 17v-3"/></svg>
                ),
                Trash: () => (
                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M3 6h18"/><path d="M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"/><path d="M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"/></svg>
                ),
                Chevron: () => (
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="m9 18 6-6-6-6"/></svg>
                ),
                Gear: () => (
                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z"/><circle cx="12" cy="12" r="3"/></svg>
                )
            };

            const APP_ID = 'game-over-tracker-v5';
            const APP_VERSION = '3.0.0';

            // Migrate data from older app versions (v1-v4) into current version
            (function migrateOldData() {
                const currentLogs = localStorage.getItem(`${APP_ID}_logs`);
                const currentHistory = localStorage.getItem(`${APP_ID}_history`);
                let mergedLogs = currentLogs ? JSON.parse(currentLogs) : {};
                let mergedHistory = currentHistory ? JSON.parse(currentHistory) : [];
                let migrated = false;

                for (let v = 1; v <= 4; v++) {
                    const oldId = `game-over-tracker-v${v}`;
                    const oldLogs = localStorage.getItem(`${oldId}_logs`);
                    const oldHistory = localStorage.getItem(`${oldId}_history`);

                    if (oldLogs) {
                        const parsed = JSON.parse(oldLogs);
                        Object.keys(parsed).forEach(key => {
                            if (!mergedLogs[key]) mergedLogs[key] = parsed[key];
                        });
                        localStorage.removeItem(`${oldId}_logs`);
                        migrated = true;
                    }

                    if (oldHistory) {
                        const parsed = JSON.parse(oldHistory);
                        const existingKeys = new Set(mergedHistory.map(h => `${h.key}_${h.date}`));
                        parsed.forEach(entry => {
                            const dedupKey = `${entry.key}_${entry.date}`;
                            if (!existingKeys.has(dedupKey)) {
                                mergedHistory.push(entry);
                                existingKeys.add(dedupKey);
                            }
                        });
                        localStorage.removeItem(`${oldId}_history`);
                        migrated = true;
                    }
                }

                if (migrated) {
                    localStorage.setItem(`${APP_ID}_logs`, JSON.stringify(mergedLogs));
                    localStorage.setItem(`${APP_ID}_history`, JSON.stringify(mergedHistory));
                    console.log('[Game Over] Migrated data from older versions');
                }
            })();

            const programData = {
                1: { title: "Conditioning", targetReps: "12-15", workouts: {
                    "Monday": [{ name: "Incline Barbell Press", sets: 4 }, { name: "Flat Barbell Press", sets: 4 }, { name: "Dumbbell Flyes", sets: 4 }, { name: "Push Ups", sets: 3 }, { name: "Crunches", sets: 4 }, { name: "Reverse Crunches", sets: 4 }],
                    "Tuesday": [{ name: "Squats", sets: 4 }, { name: "Stiff Leg Deadlift", sets: 4 }, { name: "Leg Curl", sets: 4 }, { name: "Leg Press", sets: 4 }, { name: "Leg Extension", sets: 4 }, { name: "Standing Calf Raise", sets: 4 }, { name: "Seated Calf Raise", sets: 4 }],
                    "Wednesday": [{ name: "Bent Over Barbell Row", sets: 4 }, { name: "1-Arm Dumbbell Row", sets: 4 }, { name: "Cable Pull Downs", sets: 4 }, { name: "Wide Grip Pull Downs", sets: 4 }, { name: "Dumbbell Shrugs", sets: 4 }, { name: "Hyperextensions", sets: 4 }],
                    "Friday": [{ name: "Standing Barbell Curls", sets: 4 }, { name: "Preacher Curls", sets: 4 }, { name: "Hammer Curls", sets: 3 }, { name: "Triceps Press Down", sets: 4 }, { name: "Over Head Extensions", sets: 4 }, { name: "Weighted Dips", sets: 3 }, { name: "V-ups", sets: 4 }, { name: "Leg Raises", sets: 4 }],
                    "Saturday": [{ name: "Dumbbell Military Press", sets: 4 }, { name: "Front DB Raise", sets: 4 }, { name: "Side Lateral Raise", sets: 4 }, { name: "Rear Delt Machine", sets: 4 }, { name: "Standing Calf Raise", sets: 4 }, { name: "Seated Calf Raise", sets: 4 }]
                }},
                2: { title: "Growth", targetReps: "6-10", workouts: {
                    "Monday": [{ name: "Incline Barbell Press", sets: 6 }, { name: "Flat Barbell Press", sets: 6 }, { name: "Pec Deck", sets: 4 }, { name: "Push Ups", sets: 3 }, { name: "V-ups", sets: 4 }, { name: "Leg Raises", sets: 4 }],
                    "Tuesday": [{ name: "Squats", sets: 6 }, { name: "Stiff Leg Deadlift", sets: 6 }, { name: "Leg Curl", sets: 4 }, { name: "Leg Press", sets: 6 }, { name: "Leg Extension", sets: 4 }, { name: "Standing Calf Raise", sets: 4 }, { name: "Seated Calf Raise", sets: 4 }],
                    "Wednesday": [{ name: "High Row Wide Grip", sets: 6 }, { name: "Close Grip Low Row", sets: 6 }, { name: "Wide Grip Pull Downs", sets: 6 }, { name: "Dumbbell Pullovers", sets: 4 }, { name: "Barbell Shrugs", sets: 6 }, { name: "Hyperextensions", sets: 4 }],
                    "Friday": [{ name: "Dumbbell Curls", sets: 6 }, { name: "Preacher Curls", sets: 6 }, { name: "Concentration Curls", sets: 3 }, { name: "Close Grip Press", sets: 6 }, { name: "V-Bar Press Down", sets: 6 }, { name: "Single Arm Over Head Ext", sets: 3 }, { name: "Toe Touches", sets: 4 }, { name: "Roman Chair Knee Ups", sets: 4 }],
                    "Saturday": [{ name: "Dumbbell Military Press", sets: 6 }, { name: "Front DB Raise", sets: 6 }, { name: "Side Lateral Raise", sets: 6 }, { name: "Rear Delt Machine", sets: 6 }, { name: "Standing Calf Raise", sets: 4 }, { name: "Seated Calf Raise", sets: 4 }]
                }},
                3: { title: "Strength", targetReps: "4-6", workouts: {
                    "Monday": [{ name: "Incline Barbell Press", sets: 6 }, { name: "Flat Barbell Press", sets: 6 }, { name: "Dumbbell Flyes", sets: 4 }, { name: "Push Ups", sets: 3 }, { name: "Crunches", sets: 4 }, { name: "Reverse Crunches", sets: 4 }],
                    "Tuesday": [{ name: "Squats", sets: 6 }, { name: "Stiff Leg Deadlift", sets: 6 }, { name: "Leg Curl", sets: 4 }, { name: "Leg Press", sets: 6 }, { name: "Leg Extension", sets: 4 }, { name: "Standing Calf Raise", sets: 4 }, { name: "Seated Calf Raise", sets: 4 }],
                    "Wednesday": [{ name: "Barbell Rows", sets: 6 }, { name: "One Arm Dumbbell Rows", sets: 6 }, { name: "Cable Pull Downs", sets: 4 }, { name: "Wide Grip Pull Downs", sets: 6 }, { name: "Dumbbell Shrugs", sets: 6 }, { name: "Hyperextensions", sets: 4 }],
                    "Friday": [{ name: "Barbell Curls", sets: 6 }, { name: "Preacher Curls", sets: 6 }, { name: "Hammer Curls", sets: 3 }, { name: "Triceps Press Down", sets: 6 }, { name: "Overhead Extension", sets: 6 }, { name: "Weighted Dips", sets: 3 }, { name: "V-Ups", sets: 4 }, { name: "Leg Raises", sets: 4 }],
                    "Saturday": [{ name: "Overhead Press", sets: 6 }, { name: "DB Front Raise", sets: 6 }, { name: "Side Lateral Raise", sets: 5 }, { name: "Rear Delt Fly", sets: 6 }, { name: "Standing Calf Raise", sets: 4 }, { name: "Seated Calf Raise", sets: 4 }]
                }}
            };

            function App() {
                const [view, setView] = useState('workout');
                const [phase, setPhase] = useState(1);
                const [day, setDay] = useState('Monday');
                const [logs, setLogs] = useState({});
                const [history, setHistory] = useState([]);
                const [toast, setToast] = useState(null);
                const [darkMode, setDarkMode] = useState(() => localStorage.getItem(`${APP_ID}_darkMode`) === 'true');
                const [showSettings, setShowSettings] = useState(false);

                useEffect(() => {
                    localStorage.setItem(`${APP_ID}_darkMode`, darkMode);
                    document.documentElement.classList.toggle('dark', darkMode);
                    document.querySelector('meta[name="theme-color"]').setAttribute('content', darkMode ? '#020617' : '#0f172a');
                }, [darkMode]);

                useEffect(() => {
                    const savedLogs = localStorage.getItem(`${APP_ID}_logs`);
                    const savedHistory = localStorage.getItem(`${APP_ID}_history`);
                    if (savedLogs) setLogs(JSON.parse(savedLogs));
                    if (savedHistory) setHistory(JSON.parse(savedHistory));
                }, []);

                useEffect(() => {
                    localStorage.setItem(`${APP_ID}_logs`, JSON.stringify(logs));
                }, [logs]);

                const saveSession = () => {
                    const timestamp = new Date().toISOString();
                    const sessionEntries = Object.entries(logs).map(([key, data]) => ({
                        ...data,
                        key,
                        date: timestamp.split('T')[0]
                    })).filter(entry => entry.w && entry.r);

                    const newHistory = [...history, ...sessionEntries];
                    setHistory(newHistory);
                    localStorage.setItem(`${APP_ID}_history`, JSON.stringify(newHistory));
                    setToast("PROGRESS SAVED");
                    setTimeout(() => setToast(null), 2000);
                };

                const clearData = () => {
                    if (confirm("Permanently delete all workout history?")) {
                        setLogs({}); setHistory([]);
                        localStorage.removeItem(`${APP_ID}_logs`);
                        localStorage.removeItem(`${APP_ID}_history`);
                        window.location.reload();
                    }
                };

                const allExerciseStats = useMemo(() => {
                    const exercises = programData[phase].workouts[day];
                    return exercises.map(ex => {
                        const filtered = history.filter(h => h.key.includes(ex.name));
                        if (filtered.length === 0) return { name: ex.name, avgData: [], setData: [] };
                        const setData = filtered.map(h => ({
                            date: h.date.slice(5),
                            weight: parseFloat(h.w),
                            reps: parseFloat(h.r)
                        })).sort((a, b) => a.date.localeCompare(b.date));
                        const byDate = {};
                        filtered.forEach(h => {
                            if (!byDate[h.date]) byDate[h.date] = [];
                            byDate[h.date].push({ w: parseFloat(h.w), r: parseFloat(h.r) });
                        });
                        const avgData = Object.entries(byDate).map(([date, entries]) => ({
                            date: date.slice(5),
                            avgWeight: Math.round((entries.reduce((s, e) => s + e.w, 0) / entries.length) * 10) / 10,
                            avgReps: Math.round((entries.reduce((s, e) => s + e.r, 0) / entries.length) * 10) / 10
                        })).sort((a, b) => a.date.localeCompare(b.date));
                        return { name: ex.name, avgData, setData };
                    });
                }, [history, phase, day]);

                return (
                    <div className="min-h-screen pb-24 font-sans max-w-md mx-auto relative bg-slate-50 dark:bg-slate-950">
                        {toast && <div className="fixed top-8 left-1/2 -translate-x-1/2 bg-red-600 text-white px-6 py-3 rounded-full font-bold shadow-2xl z-50 animate-bounce">{toast}</div>}

                        <header className="bg-slate-900 text-white p-6 pt-10 flex justify-between items-end">
                            <div>
                                <h1 className="text-3xl font-black italic uppercase tracking-tighter">Game Over</h1>
                                <p className="text-[10px] text-red-500 font-bold uppercase mt-2 tracking-widest">Strength Tracker</p>
                            </div>
                            <div className="flex items-center gap-1">
                                <div className="relative">
                                    <button onClick={() => setShowSettings(!showSettings)} className="text-slate-500 hover:text-slate-300 p-2"><Icons.Gear /></button>
                                    {showSettings && (
                                        <>
                                            <div className="fixed inset-0 z-40" onClick={() => setShowSettings(false)} />
                                            <div className="absolute right-0 top-full mt-2 bg-white dark:bg-slate-800 rounded-2xl shadow-xl p-4 z-50 w-48">
                                                <div className="flex items-center justify-between">
                                                    <span className="text-sm font-bold text-slate-700 dark:text-slate-200">Dark Mode</span>
                                                    <button onClick={() => setDarkMode(!darkMode)} className={`w-12 h-7 rounded-full transition-colors relative ${darkMode ? 'bg-red-600' : 'bg-slate-300'}`}>
                                                        <span className={`absolute top-0.5 w-6 h-6 bg-white rounded-full shadow transition-transform ${darkMode ? 'left-[22px]' : 'left-0.5'}`} />
                                                    </button>
                                                </div>
                                                <div className="mt-3 pt-3 border-t border-slate-200 dark:border-slate-700">
                                                    <span className="text-[10px] font-bold text-slate-400 uppercase tracking-widest">{`v${APP_VERSION}`}</span>
                                                </div>
                                            </div>
                                        </>
                                    )}
                                </div>
                                <button onClick={clearData} className="text-slate-500 hover:text-red-500 p-2"><Icons.Trash /></button>
                            </div>
                        </header>
                        
                        <nav className="flex bg-white dark:bg-slate-900 sticky top-0 z-20 shadow-sm">
                            {[1, 2, 3].map(p => (
                                <button key={p} onClick={() => setPhase(p)} className={`flex-1 py-4 text-xs font-black uppercase border-b-4 transition-colors ${phase === p ? 'border-red-600 text-red-600' : 'border-transparent text-slate-400'}`}>Phase {p}</button>
                            ))}
                        </nav>

                        {view === 'workout' ? (
                            <div className="p-4 space-y-4">
                                <div className="relative">
                                    <select value={day} onChange={(e) => setDay(e.target.value)} className="w-full p-4 bg-white dark:bg-slate-900 dark:text-white rounded-2xl border-none shadow-sm text-lg font-bold appearance-none">
                                        {Object.keys(programData[phase].workouts).map(d => <option key={d} value={d}>{d}</option>)}
                                    </select>
                                    <div className="absolute right-4 top-1/2 -translate-y-1/2 pointer-events-none text-slate-400"><Icons.Chevron /></div>
                                </div>

                                {programData[phase].workouts[day].map((ex) => (
                                    <div key={ex.name} className="bg-white dark:bg-slate-900 p-5 rounded-3xl shadow-sm border border-slate-100 dark:border-slate-800">
                                        <div className="flex justify-between items-start mb-4">
                                            <h3 className="text-sm font-black text-slate-800 dark:text-slate-100 uppercase flex items-center gap-2 text-wrap pr-2">
                                                <Icons.Dumbbell /> {ex.name}
                                            </h3>
                                            <span className="text-[10px] font-black px-2 py-1 bg-slate-100 dark:bg-slate-800 rounded text-slate-500 dark:text-slate-400 uppercase shrink-0">{ex.sets} Sets</span>
                                        </div>
                                        <div className="space-y-3">
                                            {[...Array(ex.sets)].map((_, i) => {
                                                const s = i + 1;
                                                const logKey = `${phase}-${day}-${ex.name}-s${s}`;
                                                const data = logs[logKey] || { w: '', r: '' };
                                                return (
                                                    <div key={s} className="flex gap-2 items-center">
                                                        <div className="w-8 h-8 flex items-center justify-center bg-slate-900 dark:bg-slate-700 rounded-lg text-[10px] font-black text-white shrink-0">S{s}</div>
                                                        <div className="flex-1 flex gap-2">
                                                            <input
                                                                type="number"
                                                                inputMode="decimal"
                                                                placeholder="Lbs"
                                                                value={data.w}
                                                                onChange={(e) => setLogs({...logs, [logKey]: {...data, w: e.target.value}})}
                                                                className="w-full p-3 bg-slate-50 dark:bg-slate-800 dark:text-white rounded-xl text-center font-bold outline-none focus:ring-2 focus:ring-red-500 transition-all placeholder:text-slate-300 dark:placeholder:text-slate-600"
                                                            />
                                                            <input
                                                                type="number"
                                                                inputMode="numeric"
                                                                placeholder="Reps"
                                                                value={data.r}
                                                                onChange={(e) => setLogs({...logs, [logKey]: {...data, r: e.target.value}})}
                                                                className="w-full p-3 bg-slate-50 dark:bg-slate-800 dark:text-white rounded-xl text-center font-black outline-none focus:ring-2 focus:ring-red-500 transition-all placeholder:text-slate-300 dark:placeholder:text-slate-600"
                                                            />
                                                        </div>
                                                    </div>
                                                );
                                            })}
                                        </div>
                                    </div>
                                ))}
                            </div>
                        ) : (
                            <div className="p-4 space-y-4">
                                <div className="relative">
                                    <select value={day} onChange={(e) => setDay(e.target.value)} className="w-full p-4 bg-white dark:bg-slate-900 dark:text-white rounded-2xl border-none shadow-sm text-lg font-bold appearance-none">
                                        {Object.keys(programData[phase].workouts).map(d => <option key={d} value={d}>{d}</option>)}
                                    </select>
                                    <div className="absolute right-4 top-1/2 -translate-y-1/2 pointer-events-none text-slate-400"><Icons.Chevron /></div>
                                </div>

                                {allExerciseStats.map(exStat => (
                                    <div key={exStat.name} className="bg-white dark:bg-slate-900 p-5 rounded-3xl shadow-sm border border-slate-100 dark:border-slate-800">
                                        <h3 className="text-sm font-black text-slate-800 dark:text-slate-100 uppercase flex items-center gap-2 mb-4">
                                            <Icons.Dumbbell /> {exStat.name}
                                        </h3>
                                        {exStat.avgData.length > 0 ? (
                                            <div className="h-64">
                                                <ResponsiveContainer width="100%" height="100%">
                                                    <ComposedChart data={exStat.avgData}>
                                                        <CartesianGrid strokeDasharray="3 3" vertical={false} stroke={darkMode ? '#1e293b' : '#f1f5f9'} />
                                                        <XAxis dataKey="date" fontSize={10} tickLine={false} axisLine={false} tick={{ fill: darkMode ? '#94a3b8' : '#64748b' }} />
                                                        <YAxis yAxisId="weight" fontSize={10} tickLine={false} axisLine={false} tick={{ fill: darkMode ? '#94a3b8' : '#64748b' }} label={{ value: 'Lbs', angle: -90, position: 'insideLeft', style: { fontSize: 10, fill: '#94a3b8' } }} />
                                                        <YAxis yAxisId="reps" orientation="right" fontSize={10} tickLine={false} axisLine={false} tick={{ fill: darkMode ? '#94a3b8' : '#64748b' }} label={{ value: 'Reps', angle: 90, position: 'insideRight', style: { fontSize: 10, fill: '#94a3b8' } }} />
                                                        <Tooltip contentStyle={{borderRadius: '16px', border: 'none', boxShadow: '0 4px 6px -1px rgb(0 0 0 / 0.1)', backgroundColor: darkMode ? '#1e293b' : '#fff', color: darkMode ? '#e2e8f0' : '#000'}} />
                                                        <Legend verticalAlign="top" height={36} wrapperStyle={{fontSize: '10px', fontWeight: 'bold', color: darkMode ? '#e2e8f0' : undefined}} />
                                                        <Line yAxisId="weight" type="monotone" name="Avg Weight" dataKey="avgWeight" stroke="#ef4444" strokeWidth={2} dot={false} />
                                                        <Line yAxisId="reps" type="monotone" name="Avg Reps" dataKey="avgReps" stroke="#3b82f6" strokeWidth={2} dot={false} />
                                                        <Scatter yAxisId="weight" name="Weight" data={exStat.setData} dataKey="weight" fill="#ef4444" opacity={0.5} />
                                                        <Scatter yAxisId="reps" name="Reps" data={exStat.setData} dataKey="reps" fill="#3b82f6" opacity={0.5} />
                                                    </ComposedChart>
                                                </ResponsiveContainer>
                                            </div>
                                        ) : (
                                            <div className="flex items-center justify-center h-32 text-center text-slate-400 font-bold uppercase text-xs">No data yet</div>
                                        )}
                                    </div>
                                ))}
                            </div>
                        )}

                        <div className="fixed bottom-0 left-0 right-0 bg-white/80 dark:bg-slate-900/80 backdrop-blur-xl border-t dark:border-slate-800 p-4 max-w-md mx-auto grid grid-cols-3 z-30">
                            <button onClick={() => setView('workout')} className={`flex flex-col items-center gap-1 transition-colors ${view === 'workout' ? 'text-red-600' : 'text-slate-400'}`}><Icons.Calendar /> <span className="text-[10px] font-black uppercase">Log</span></button>
                            <button onClick={saveSession} className="bg-red-600 text-white p-4 rounded-2xl shadow-lg -mt-8 flex justify-center active:scale-95 transition-all transform"><Icons.Save /></button>
                            <button onClick={() => setView('stats')} className={`flex flex-col items-center gap-1 transition-colors ${view === 'stats' ? 'text-red-600' : 'text-slate-400'}`}><Icons.BarChart3 /> <span className="text-[10px] font-black uppercase">Stats</span></button>
                        </div>
                    </div>
                );
            }

            const rootElement = document.getElementById('root');
            const root = ReactDOM.createRoot(rootElement);
            root.render(<App />);
        };

        initApp();
    </script>
</body>
</html>
